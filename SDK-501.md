# SDK-501  
## Agent Integration Specification  
**Status:** Draft v1.0  
**Category:** Developer Infrastructure  

---

# 1. Purpose

This specification defines how intelligent agents, applications, and user clients integrate with the Tetcore network.

It governs:

- Local prompt storage
- Wallet integration
- Private key management
- Client-side behavior for inference lifecycle

Agents are off-chain software components that interact with Tetcore via transactions and transport protocols.

---

# 2. Agent Definition

An Agent is a client application capable of:

- Constructing transactions
- Managing keys
- Encrypting prompts
- Handling transport
- Verifying receipts
- Managing local inference data

Agents do not participate in consensus.

---

# 3. Local Prompt Storage

---

## 3.1 Mandatory Local Retention

Agents MUST locally store:

- prompt_bytes
- salt
- output_bytes (optional)
- output_salt (if generated locally)
- prompt_tx_hash

Protocol does NOT store plaintext prompt on-chain.

Loss of local storage results in irrecoverable prompt data.

---

## 3.2 Storage Security Requirements

Local prompt storage must:

- Be encrypted at rest
- Use secure OS keychain where available
- Avoid plaintext logging
- Avoid external cloud sync unless encrypted

---

## 3.3 Data Deletion

Agents SHOULD provide:

Secure deletion functionality.

Deletion removes:

- Prompt
- Salt
- Output

Deletion must not affect on-chain commitments.

---

# 4. Wallet Integration

---

## 4.1 Wallet Role

Wallet manages:

- Private keys
- Account nonce
- Balance tracking
- Transaction signing
- Governance voting

Wallet may be:

- Embedded in agent
- External wallet connected via API

---

## 4.2 Required Capabilities

Wallet must:

- Sign SubmitPrompt
- Sign SubmitReceipt (if operator)
- Sign Transfer
- Sign GovernanceProposal

Wallet must not:

- Expose private key to transport layer
- Sign transactions without user consent (unless delegated)

---

## 4.3 Transaction Construction Flow

For inference:

1. Agent generates salt
2. Compute prompt_commitment
3. Construct SubmitPrompt
4. Wallet signs transaction
5. Broadcast to network

After receipt:

6. Verify receipt
7. Update local state

---

# 5. Key Management

---

## 5.1 Key Scheme

Keys must comply with:

TET-003 Network Identity Specification.

Default scheme:

Ed25519

---

## 5.2 Key Storage

Private keys must:

- Be stored encrypted
- Be password-protected or hardware-backed
- Not be stored in plaintext files

Hardware wallet support recommended.

---

## 5.3 Key Derivation

Agents may support:

Hierarchical deterministic (HD) derivation.

Each account derived from:

Master seed using deterministic path.

---

## 5.4 Key Recovery

Recovery must rely on:

- Seed phrase
- Deterministic derivation path

Protocol does not provide account recovery.

---

# 6. Client Behavior: Inference Lifecycle

---

## 6.1 SubmitPrompt Phase

Agent must:

- Verify model is active
- Calculate expected fee
- Define escrow limit
- Sign and submit transaction
- Monitor confirmation

---

## 6.2 Transport Phase

If relay_mode == 0:

Route via relay

If relay_mode == 1:

Direct delivery

Prompt must be:

Encrypted before transmission

---

## 6.3 Receipt Verification

Upon receipt:

Agent must:

- Verify operator signature
- Verify output_commitment matches output
- Validate token counts against expectations
- Ensure fee ≤ escrow

If mismatch:

Optionally trigger dispute (future extension).

---

# 7. Fee Estimation

Agent must:

- Query model pricing
- Estimate input/output token usage
- Include congestion multiplier
- Display estimated fee to user

Estimated fee must not exceed:

Escrow limit set by user.

---

# 8. Nonce Management

Agent must:

- Track account nonce
- Prevent duplicate nonce submission
- Resync nonce from network if mismatch

Nonce misuse results in transaction rejection.

---

# 9. Privacy Responsibilities

Agent must:

- Never send plaintext prompt on-chain
- Use strong salt
- Use secure encryption for transport
- Avoid telemetry leaking prompt contents

Privacy is primarily agent responsibility.

---

# 10. Multi-Model Support

Agent should support:

- Multiple model registries
- Multiple model versions
- Dynamic pricing modes
- Model vault participation

---

# 11. Failure Handling

If:

Receipt not submitted before deadline

Agent must:

- Detect expiry
- Confirm escrow refund
- Notify user

Transport failure must not compromise escrow.

---

# 12. Vault Participation

If staking:

Agent must:

- Track shares
- Calculate expected rewards
- Handle withdrawal delay
- Display share balance and yield

Vault logic executed on-chain.

---

# 13. Governance Participation

Agent must:

- Display active proposals
- Allow voting
- Display quorum and thresholds
- Prevent double voting

Voting requires signed transaction.

---

# 14. Security Requirements

Agents must protect against:

- Phishing
- Key exfiltration
- Replay attacks
- Malicious relay injection
- Incorrect fee estimation

Agents must verify:

Chain ID before signing.

---

# 15. Determinism Boundary

Agent behavior must not affect:

- Consensus rules
- Fee calculation
- Revenue routing
- State transitions

Agent logic is off-chain.

---

# 16. API Requirements

Agents may expose:

- QueryModel(model_id)
- SubmitPrompt(prompt)
- CheckReceipt(prompt_tx_hash)
- Stake(model_id, amount)
- Vote(proposal_id)

All APIs must validate inputs.

---

# 17. Multi-Agent Architecture

Agents may operate as:

- User client
- Enterprise gateway
- Autonomous AI agent
- Inference operator controller

All must adhere to same signing and privacy rules.

---

# 18. Upgrade Compatibility

Agent must:

- Track runtime version
- Adapt to ABI changes
- Handle new capability requirements

If incompatible:

Agent must refuse signing until updated.

---

# 19. Formal Agent Responsibilities

Agent ensures:

- Correct commitment generation
- Secure key usage
- Accurate fee bounding
- Local data retention
- Signature authenticity

Agent does NOT:

- Validate consensus
- Enforce revenue routing
- Verify semantic correctness of inference

---

# 20. Conclusion

SDK-501 defines the Agent Integration Specification as:

- Local-storage centric
- Wallet-secured
- Privacy-preserving
- Deterministically interacting
- Fully compatible with IFP and TVM

Agents are the human and AI-facing interface to Tetcore’s intelligence infrastructure.

They are responsible for privacy, key security, and transaction correctness.

---

End of SDK-501.